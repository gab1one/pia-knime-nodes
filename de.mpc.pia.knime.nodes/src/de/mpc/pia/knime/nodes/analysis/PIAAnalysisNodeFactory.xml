<?xml version="1.0" encoding="UTF-8"?>
<knimeNode icon="./pia_logo_16x16.png" type="Predictor" xmlns="http://knime.org/node/v2.8" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://knime.org/node/v2.10 http://knime.org/node/v2.10.xsd">
    <name>PIA Analysis</name>
    
    <shortDescription>
        PIA Analysis
    </shortDescription>
    
    <fullDescription>
        <intro>This is the PIA Analysis for a PIA intermediate file generated by the PIA Compiler.</intro>
        
        <tab name="general settings">
            <option name="column to PIA XML file (on port 0)">Select the column of the incoming table, which holds the PIA XML file created by the PIA Compiler. Only the first entry will be used. If either input port 1 or 2 are used, don't set this.</option>
            <option name="Fail on no decoys">Select this if a decoy database was used for spectrum identification. This checks, whether any decoy was detected using the settings on the PSM level and stops the execution, if none was found, which is probably due to erroneous settings.</option>
            <option name="Create PSM sets">Select this option, if multiple search engines were used for spectrum identification. PIA will try to put identifications of the same spectrum in one set and allows the calculation of the Combined FDR Score as a meta score combining all search engines results in one PSM set.</option>
            <option name="consider modifications to distinguish peptides">Usually a peptide is defined only by the amino acid sequence. Select this, to distinguish peptides also by modifications.</option>
            
        	<option name="Export level">Currently only one file can be exported and will be written to output port 3. Select here, which level (PSMs, peptides, proteins) should be exported or none to disable export.</option>
        	<option name="Export format">Select the format of the exported file.</option>
        </tab>
        
        <tab name="PSMs settings">
            <option name="FileID for PSM output">PIA exports the PSMs of the merge/overview of all files or one file only at the moment. Select 0 for the overview/merge or 1..n for a specific file. You can get the IDs of the compiled files by inspecting the summary view of the compiler. Usually, the order of the files given to the compiler is maintained.</option>
            <option name="Calculate FDR for all files">Select whether the FDR for all files should be estimated, based on the Target Decoy Approach. This includes calculation of the FDR Score (a smoothed FDR), on PSM and other supported levels. This is needed for merging the results of multiple search engines with the Combined FDR Score.</option>
            <option name="Calculate Combined FDR Score">The Combined FDR Score can be used to combine the results of multiple search engine runs on a single file. Needs creation of PSM sets on general settings.</option>
            
        	<option name="accession pattern">Select this option if the spectra were identified against a target-decoy-database and decoys entries can be identified by a regular accession.</option>
        	<option name="by searchengine">Select this option if entries were assigned as target or decoy by the search engine (e.g. when selecting "Decoy search" in Mascot) or a preprocessing step.</option>
        	
        	<option name="only top identification">Use only the best identification per spectrum and discard all other identifications (they will get NA as FDR and can thus be filtered).</option>
        	<option name="all identifications">Use all identifications per spectrum, not only the top scoring. Sometimes the more probable identification does not get the best rank.</option>
        	
            <option name="Preferred PSM scores">Select the preferred scores used for the FDR estimation. If a file contains one of these scores, it will be used for the FDR estimation of this file. If not, or no score is selected, default scores will be used.</option>
            
            <option name="Filters for PSM level">Selected filters here will be used for the creation of the PSM table on port 0 and for PSM level export. It will not interfere with peptide or protein inference.</option>
        </tab>
        
        <tab name="peptides settings">
            <option name="Infere peptides">Protein inference can be turned off, does not interfere with protein inference. Can save some time, if peptide level information is not needed.</option>
            <option name="FileID for peptide output">PIA exports the peptides of the merge/overview of all files or one file only at the moment. Select 0 for the overview/merge or 1..n for a specific file. You can get the IDs of the compiled files by inspecting the summary view of the compiler. Usually, the order of the files given to the compiler is maintained.</option>
            <option name="Filters for peptide level">Selected filters here will be used for the creation of the peptide table on port 1 and for peptide level export. It will not interfere with protein inference.</option>
        </tab>
           
        <tab name="proteins settings">
            <option name="Infere proteins">Turn off protein inference, if no protein level data should be generated.</option>
            <option name="Inference method">Select the inference method here. Spectrum Extractor is the recommended method, while "Report all" is no inference, but just reports all possible protein groups from the PSM data.</option>
            <option name="Inference filters">Select filters here for the PSMs and peptides used for the protein inference. Here e.g. the FDR filtering on PSM level should be selected.</option>
            <option name="Scoring method">Select "additive scoring" for scores, which have a higher score better (e.g. Mascot Ion Score, X!Tandem Hyperscore), or "multiplicative scoring" for scores with smaller score better (e.g. FDR Score, Mascot Expect). Use the geometric mean scoring only, if you know, what you are doing.</option>
            <option name="Basescore for protein scoring">Select the PSM score used for the calculation of the protein scores here. If the (Combined) FDR Score was calculated, it is recommended to use it. Take care to select a score, that is created by PIA or the search engine(s).</option>
            <option name="PSMs used for scoring">By default, only the best PSM score per peptide is used for protein scoring. If multiple PSMs per peptide should influence the score, use all PSMs.</option>
            <option name="Filters for protein level">Selected filters here will be used for the creation of the protein table on port 2 and for protein level export. It will not directly interfere with protein inference, but only the representation of the inferred groups in the mentioned exports.</option>
        </tab>
        	
        <tab name="Privacy information">
        	<option name="Collection of anonymous usage statistics">The PIA team is collecting usage statistics for quality control and, most important, funding purposes. If you don't like to provide the anonymous usage data, disable it in the KNIME preferences.</option>
        </tab>
    </fullDescription>
    
    <ports>
        <inPort index="0" name="PIA XML file (from table)">A PIA XML file from a table, may be gzipped. This would be the default output of the PIA Compiler. Either this or a file in port 1 must be given.</inPort>
        <inPort index="1" name="PIA XML file (from port)">A PIA XML file from a file port, e.g. from Input File.  Either this or a file in port 0 must be given. Only the first suitable file in the port will be used.</inPort>
        <inPort index="2" name="spectrum file">An optional spectrum file for the spectrum viewer (not yet fully implemented).</inPort>
        
        <outPort index="0" name="PSM results">The results on the PSM level.</outPort>
        <outPort index="1" name="peptide results">The results on the peptide level.</outPort>
        <outPort index="2" name="protein results">The results on the protein level.</outPort>
        <outPort index="3" name="export file">The generated export file (not yet implemented for CSV).</outPort>
    </ports>    
    <views>
        <view index="0" name="PIA Result Analysis">The PIA Analysis view: browse the PSM, peptide and protein results and visualise the results.</view>
        <view index="1" name="PSM Spectrum viewer">Spectrum viewer on PSM level. Node must be connected to a spectrum file to create useful output.</view>
    </views>
</knimeNode>
